dovecot:
  language: "c"
  image: "fuzzdrivergpt/dovecot:env"
  apiblocklist: [ "^$" ]
  precode: '#include <stdbool.h>\n'
  headers: { "/root/workspace/fuzzdrivergpt/install/include" : "**/*" }
  binaries: [ "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib01_acl_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib02_imap_acl_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib02_lazy_expunge_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib05_mail_crypt_acl_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib05_pop3_migration_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib10_last_login_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib10_mail_crypt_plug in.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib10_quota_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib11_imap_quota_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib11_trash_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib15_notify_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib20_charset_alias_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib20_fts_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib20_listescape_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib20_mail_compress_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib20_mail_log_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib20_notify_status_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib20_push_notification_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib20_quota_clone_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib20_replication_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib20_var_expand_crypt.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib20_virtual_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/lib99_welcome_plugin.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/libdcrypt_openssl.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-compression.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-dsync.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-fts.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-lda.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-login.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-sql.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-storage.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/libfs_compress.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/libfs_crypt.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/libfs_mail_crypt.a", "/root/workspace/fuzzdrivergpt/install/lib/dovecot/libssl_iostream_openssl.a" ]
  compile: [ "/usr/local/bin/clang-15", "-isystem", "/usr/local/lib/clang/15.0.0/include", "-isystem", "/usr/local/include", "-isystem", "/usr/include/x86_64-linux-gnu", "-isystem", "/usr/include", "-fsanitize=address", "-fsanitize=fuzzer", "-DHAVE_CONFIG_H","-I/root/workspace/fuzzdrivergpt/install/include","-fPIE","-DPIE","-std=gnu11","-O1","-fno-omit-frame-pointer","-gline-tables-only","-DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION","-fsanitize=address","-fsanitize-address-use-after-scope","-fsanitize=fuzzer-no-link","-fstack-protector-strong","-U_FORTIFY_SOURCE","-D_FORTIFY_SOURCE=2","-fsanitize=fuzzer-no-link","-Wall","-W","-Wmissing-prototypes","-Wmissing-declarations","-Wpointer-arith","-Wchar-subscripts","-Wformat=2","-Wbad-function-cast","-Wno-duplicate-decl-specifier","-Wstrict-aliasing=2" ]
  build: "COMPBASE OUTFILE -Wl,--as-needed -Wl,--export-dynamic /root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot.a  /root/workspace/fuzzdrivergpt/install/lib/dovecot/libdcrypt_openssl.a /root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-compression.a /root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-dsync.a /root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-fts.a /root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-lda.a /root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-login.a /root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-sql.a /root/workspace/fuzzdrivergpt/install/lib/dovecot/libdovecot-storage.a /root/workspace/fuzzdrivergpt/install/lib/dovecot/libfs_compress.a /root/workspace/fuzzdrivergpt/install/lib/dovecot/libfs_crypt.a /root/workspace/fuzzdrivergpt/install/lib/dovecot/libfs_mail_crypt.a /root/workspace/fuzzdrivergpt/install/lib/dovecot/libssl_iostream_openssl.a -o OUTEXE"
  run: "OUTEXE -detect_leaks=0 -max_total_time=60 -timeout=30 -artifact_prefix=ARTIFACTDIR/ -close_fd_mask=3 SEEDDIR"
  known_drivers: [ "/src/dovecot/src/lib-imap/fuzz-imap-bodystructure.c", "/src/dovecot/src/lib-imap/fuzz-imap-utf7.c", "/src/dovecot/src/lib-mail/fuzz-message-parser.c", "/src/dovecot/src/lib-smtp/fuzz-smtp-server.c", ]

#clang -DHAVE_CONFIG_H -I. -I../..  -I../../src/lib -I../../src/lib-test -I../../src/lib-settings -I../../src/lib-master -I../../src/lib-sasl -I../../src/lib-auth -I../../src/lib-ssl-iostream -I../../src/lib-dns -I../../src/lib-program-client -I../../src/lib-mail -DTEST_BIN_DIR=\"/src/dovecot/src/lib-smtp/test-bin\" -fPIE -DPIE   -std=gnu11 -O1 -fno-omit-frame-pointer -gline-tables-only -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -fstack-protector-strong -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -fsanitize=fuzzer-no-link -Wall -W -Wmissing-prototypes -Wmissing-declarations -Wpointer-arith -Wchar-subscripts -Wformat=2 -Wbad-function-cast -Wno-duplicate-decl-specifier -Wstrict-aliasing=2  -MT fuzz_smtp_server-fuzz-smtp-server.o -MD -MP -MF .deps/fuzz_smtp_server-fuzz-smtp-server.Tpo -c -o fuzz_smtp_server-fuzz-smtp-server.o `test -f 'fuzz-smtp-server.c' || echo './'`fuzz-smtp-server.c
#
#
#
#clang++ -O1 -fno-omit-frame-pointer -gline-tables-only -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -stdlib=libc++ -D__STDC_LIMIT_MACROS -fsanitize=fuzzer -Wl,--as-needed -o fuzz-smtp-server fuzz_smtp_server-fuzz-smtp-server.o -Wl,--export-dynamic  ./.libs/libsmtp.a ../lib-program-client/.libs/libprogram_client.a ../lib-dns/.libs/libdns.a ../lib-mail/.libs/libmail.a ../lib-charset/.libs/libcharset.a ../lib-master/.libs/libmaster.a ../lib-auth/.libs/libauth.a ../lib-ssl-iostream/.libs/libssl_iostream.a ../lib-settings/.libs/libsettings.a ../lib-sasl/.libs/libsasl.a ../lib-test/.libs/libtest.a ../lib/.libs/liblib.a

#./.libs/libsmtp.a ../lib-program-client/.libs/libprogram_client.a ../lib-dns/.libs/libdns.a ../lib-mail/.libs/libmail.a ../lib-charset/.libs/libcharset.a ../lib-master/.libs/libmaster.a ../lib-auth/.libs/libauth.a ../lib-ssl-iostream/.libs/libssl_iostream.a ../lib-settings/.libs/libsettings.a ../lib-sasl/.libs/libsasl.a ../lib-test/.libs/libtest.a ../lib/.libs/liblib.a

