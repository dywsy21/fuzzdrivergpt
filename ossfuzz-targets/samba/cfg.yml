samba:
  language: "c"
  image: "fuzzdrivergpt/samba:env"
  apiblocklist: [ "^$" ]
  precode: '#include <stdbool.h>\n'
  headers: { "/usr/local/samba/include" : "**/*.h" }
  binaries: [ "/usr/local/samba/lib/libdcerpc-binding.so","/usr/local/samba/lib/libdcerpc-samr.so","/usr/local/samba/lib/libdcerpc-server-core.so","/usr/local/samba/lib/libdcerpc-server.so","/usr/local/samba/lib/libdcerpc.so","/usr/local/samba/lib/libndr-krb5pac.so","/usr/local/samba/lib/libndr-nbt.so","/usr/local/samba/lib/libndr-standard.so","/usr/local/samba/lib/libndr.so","/usr/local/samba/lib/libnetapi.so","/usr/local/samba/lib/libsamba-credentials.so","/usr/local/samba/lib/libsamba-errors.so","/usr/local/samba/lib/libsamba-hostconfig.so","/usr/local/samba/lib/libsamba-passdb.so","/usr/local/samba/lib/libsamba-policy.cpython-38-x86-64-linux-gnu.so","/usr/local/samba/lib/libsamba-util.so","/usr/local/samba/lib/libsamdb.so","/usr/local/samba/lib/libsmbclient.so","/usr/local/samba/lib/libsmbconf.so","/usr/local/samba/lib/libsmbldap.so","/usr/local/samba/lib/libtevent-util.so","/usr/local/samba/lib/libwbclient.so" ]
  compile: [ "/usr/local/bin/clang-15", "-isystem", "/usr/local/lib/clang/15.0.0/include", "-isystem", "/usr/local/include", "-isystem", "/usr/include/x86_64-linux-gnu", "-isystem", "/usr/include", "-fsanitize=address", "-fsanitize=fuzzer","-I/root/workspace/fuzzdrivergpt/install/include", "-D_SAMBA_BUILD_=4", "-DHAVE_CONFIG_H=1", "-MMD", "-D_GNU_SOURCE=1", "-D_XOPEN_SOURCE_EXTENDED=1", "-DHAVE_CONFIG_H=1", "-fPIE", "-DDEVELOPER", "-DDEBUG_PASSWORD", "-fPIC", "-D__STDC_WANT_LIB_EXT1__=1", "-D_REENTRANT", "-DDEVELOPER", "-DDEBUG_PASSWORD", "-fstack-protector-strong", "-fstack-clash-protection", "-g", "-g", "-Wall", "-Wshadow", "-Wmissing-prototypes", "-Wmissing-field-initializers", "-Wformat-zero-length", "-Wcast-align", "-Wcast-qual", "-fno-common", "-Werror=address", "-Werror=strict-prototypes", "-Wstrict-prototypes", "-Werror=write-strings", "-Wwrite-strings", "-Werror-implicit-function-declaration", "-Werror=implicit-int", "-Werror=pointer-arith", "-Wpointer-arith", "-Werror=declaration-after-statement", "-Wdeclaration-after-statement", "-Werror=return-type", "-Wreturn-type", "-Werror=uninitialized", "-Wuninitialized", "-Wimplicit-fallthrough", "-Werror=strict-overflow", "-Wstrict-overflow=2", "-Werror=old-style-definition", "-Wold-style-definition", "-Wformat=2", "-Wno-format-y2k", "-Wno-format-zero-length", "-Werror=format-security", "-Wformat-security", "-Werror=format", "-g", "-O1", "-fno-omit-frame-pointer", "-fsanitize=address", "-O1", "-fno-omit-frame-pointer", "-gline-tables-only", "-DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION", "-fsanitize=address", "-fsanitize-address-use-after-scope", "-fsanitize=fuzzer-no-link", "-I/usr/local/samba/include", "-I/src/samba/lib/addns", "-I/src/samba/lib/afs", "-I/src/samba/lib/async_req", "-I/src/samba/lib/audit_logging", "-I/src/samba/lib/cmdline", "-I/src/samba/lib/compression", "-I/src/samba/lib/crypto", "-I/src/samba/lib/dbwrap", "-I/src/samba/lib/fuzzing", "-I/src/samba/lib/krb5_wrap", "-I/src/samba/lib/ldb", "-I/src/samba/lib/ldb-samba", "-I/src/samba/lib/messaging", "-I/src/samba/lib/mscat", "-I/src/samba/lib/param", "-I/src/samba/lib/printer_driver", "-I/src/samba/lib/pthreadpool", "-I/src/samba/lib/replace", "-I/src/samba/lib/smbconf", "-I/src/samba/lib/socket", "-I/src/samba/lib/talloc", "-I/src/samba/lib/tdb", "-I/src/samba/lib/tdb_wrap", "-I/src/samba/lib/tdr", "-I/src/samba/lib/tevent", "-I/src/samba/lib/texpect", "-I/src/samba/lib/torture", "-I/src/samba/lib/tsocket", "-I/src/samba/lib/util" ]
  build: "COMPBASE OUTFILE -Wl,-rpath,/src/samba/bin/shared -Wl,-rpath,/src/samba/bin/shared/private -Wl,-Bstatic -Wl,-Bdynamic -ldcerpc-binding -ldcerpc-samr -ldcerpc-server-core -ldcerpc-server -ldcerpc -lndr-krb5pac -lndr-nbt -lndr-standard -lndr -lnetapi -lsamba-credentials -lsamba-errors -lsamba-hostconfig -lsamba-passdb -lsamba-policy.cpython-38-x86-64-linux-gnu -lsamba-util -lsamdb -lsmbclient -lsmbconf -lsmbldap -ltevent-util -lwbclient -lbsd -ldl -lsystemd -Wl,--disable-new-dtags -pie -Wl,-z,relro,-z,now -Wl,--export-dynamic -o OUTEXE"
  run: "OUTEXE -detect_leaks=0 -max_total_time=60 -timeout=30 -artifact_prefix=ARTIFACTDIR/ -close_fd_mask=3 SEEDDIR"
  known_drivers: [ "/src/samba/lib/fuzzing/afl-fuzz-main.c","/src/samba/lib/fuzzing/fuzz_cli_credentials_parse_string.c","/src/samba/lib/fuzzing/fuzz_dcerpc_parse_binding.c","/src/samba/lib/fuzzing/fuzz_ldap_decode.c","/src/samba/lib/fuzzing/fuzz_ldb_dn_explode.c","/src/samba/lib/fuzzing/fuzz_ldb_ldif_read.c","/src/samba/lib/fuzzing/fuzz_ldb_parse_binary_decode.c","/src/samba/lib/fuzzing/fuzz_ldb_parse_control.c","/src/samba/lib/fuzzing/fuzz_ldb_parse_tree.c","/src/samba/lib/fuzzing/fuzz_lzxpress.c","/src/samba/lib/fuzzing/fuzz_lzxpress_compress.c","/src/samba/lib/fuzzing/fuzz_lzxpress_huffman_compress.c","/src/samba/lib/fuzzing/fuzz_lzxpress_huffman_decompress.c","/src/samba/lib/fuzzing/fuzz_lzxpress_huffman_round_trip.c","/src/samba/lib/fuzzing/fuzz_lzxpress_round_trip.c","/src/samba/lib/fuzzing/fuzz_ndr_X.c","/src/samba/lib/fuzzing/fuzz_nmblib_parse_packet.c","/src/samba/lib/fuzzing/fuzz_oLschema2ldif.c","/src/samba/lib/fuzzing/fuzz_parse_lpq_entry.c","/src/samba/lib/fuzzing/fuzz_reg_parse.c","/src/samba/lib/fuzzing/fuzz_regfio.c","/src/samba/lib/fuzzing/fuzz_stable_sort.c","/src/samba/lib/fuzzing/fuzz_stable_sort_r.c","/src/samba/lib/fuzzing/fuzz_tiniparser.c","/src/samba/lib/fuzzing/fuzzing.c" ]


#"clang", "-D_SAMBA_BUILD_=4", "-DHAVE_CONFIG_H=1", "-MMD", "-D_GNU_SOURCE=1", "-D_XOPEN_SOURCE_EXTENDED=1", "-DHAVE_CONFIG_H=1", "-fPIE", "-DDEVELOPER", "-DDEBUG_PASSWORD", "-fPIC", "-D__STDC_WANT_LIB_EXT1__=1", "-D_REENTRANT", "-DDEVELOPER", "-DDEBUG_PASSWORD", "-fstack-protector-strong", "-fstack-clash-protection", "-g", "-g", "-Wall", "-Wshadow", "-Wmissing-prototypes", "-Wmissing-field-initializers", "-Wformat-zero-length", "-Wcast-align", "-Wcast-qual", "-fno-common", "-Werror=address", "-Werror=strict-prototypes", "-Wstrict-prototypes", "-Werror=write-strings", "-Wwrite-strings", "-Werror-implicit-function-declaration", "-Werror=implicit-int", "-Werror=pointer-arith", "-Wpointer-arith", "-Werror=declaration-after-statement", "-Wdeclaration-after-statement", "-Werror=return-type", "-Wreturn-type", "-Werror=uninitialized", "-Wuninitialized", "-Wimplicit-fallthrough", "-Werror=strict-overflow", "-Wstrict-overflow=2", "-Werror=old-style-definition", "-Wold-style-definition", "-Wformat=2", "-Wno-format-y2k", "-Wno-format-zero-length", "-Werror=format-security", "-Wformat-security", "-Werror=format", "-g", "-O1", "-fno-omit-frame-pointer", "-fsanitize=address", "-O1", "-fno-omit-frame-pointer", "-gline-tables-only", "-DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION", "-fsanitize=address", "-fsanitize-address-use-after-scope", "-fsanitize=fuzzer-no-link", "-DSTATIC_fuzz_lzxpress_round_trip_MODULES=NULL", "-DSTATIC_fuzz_lzxpress_round_trip_MODULES_PROTO=extern void __fuzz_lzxpress_round_trip_dummy_module_proto(void)", "-Ilib/fuzzing", "-I../../lib/fuzzing", "-Iinclude/public", "-I../../include/public", "-Isource4", "-I../../source4", "-Ilib", "-I../../lib", "-Isource4/lib", "-I../../source4/lib", "-Isource4/include", "-I../../source4/include", "-Iinclude", "-I../../include", "-Ilib/replace", "-I../../lib/replace", "-I.", "-I../..", "-Ilib/talloc", "-I../../lib/talloc", "-Ilib/util/lib/util/debug-classes", "-I../../lib/util/lib/util/debug-classes", "-Ilib/util/src/samba/third_party/gpfs", "-I../../lib/util/src/samba/third_party/gpfs", "-Ilib/compression", "-I../../lib/compression", "../../lib/fuzzing/fuzz_lzxpress_round_trip.c", "-c", "-o/src/samba/bin/default/lib/fuzzing/fuzz_lzxpress_round_trip.c.18.o"]
#
#01:23:51 runner ["clang", "lib/util/blocking.c.17.o", "lib/talloc/talloc.c.2.o", "lib/compression/lzxpress.c.1.o", "lib/compression/lzxpress_huffman.c.1.o", "lib/fuzzing/fuzzing.c.1.o", "lib/util/gpfswrap.c.13.o", "lib/util/stable_sort.c.39.o", "lib/util/time_basic.c.1.o", "lib/replace/replace.c.3.o", "lib/util/debug.c.14.o", "lib/fuzzing/fuzz_lzxpress_round_trip.c.18.o", "lib/util/close_low_fd.c.9.o", "-o/src/samba/bin/default/lib/fuzzing/fuzz_lzxpress_round_trip", "-Wl,-rpath,/src/samba/bin/shared", "-Wl,-rpath,/src/samba/bin/shared/private", "-Wl,-Bstatic", "-Wl,-Bdynamic", "-lbsd", "-ldl", "-lsystemd", "-Wl,--disable-new-dtags", "-fsanitize=fuzzer", "-pie", "-Wl,-z,relro,-z,now", "-Wl,--export-dynamic", "-fsanitize=address"