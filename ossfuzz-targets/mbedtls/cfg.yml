mbedtls:
  language: "c"
  image: "fuzzdrivergpt/mbedtls:env"
  apiblocklist: [ "^$" ]
  precode: '#include "mbedtls/aes.h"\n#include "mbedtls/compat-2.x.h"\n#include "mbedtls/hkdf.h"\n#include "mbedtls/pkcs5.h"\n#include "mbedtls/ssl_cache.h"\n#include "mbedtls/aria.h"\n#include "mbedtls/config_psa.h"\n#include "mbedtls/hmac_drbg.h"\n#include "mbedtls/pkcs7.h"\n#include "mbedtls/ssl_ciphersuites.h"\n#include "mbedtls/asn1.h"\n#include "mbedtls/constant_time.h"\n#include "mbedtls/legacy_or_psa.h"\n#include "mbedtls/platform.h"\n#include "mbedtls/ssl_cookie.h"\n#include "mbedtls/asn1write.h"\n#include "mbedtls/ctr_drbg.h"\n#include "mbedtls/lms.h"\n#include "mbedtls/platform_time.h"\n#include "mbedtls/ssl_ticket.h"\n#include "mbedtls/base64.h"\n#include "mbedtls/debug.h"\n#include "mbedtls/mbedtls_config.h"\n#include "mbedtls/platform_util.h"\n#include "mbedtls/threading.h"\n#include "mbedtls/bignum.h"\n#include "mbedtls/des.h"\n#include "mbedtls/md.h"\n#include "mbedtls/poly1305.h"\n#include "mbedtls/timing.h"\n#include "mbedtls/build_info.h"\n#include "mbedtls/dhm.h"\n#include "mbedtls/md5.h"\n#include "mbedtls/private_access.h"\n#include "mbedtls/version.h"\n#include "mbedtls/camellia.h"\n#include "mbedtls/ecdh.h"\n#include "mbedtls/memory_buffer_alloc.h"\n#include "mbedtls/psa_util.h"\n#include "mbedtls/x509.h"\n#include "mbedtls/ccm.h"\n#include "mbedtls/ecdsa.h"\n#include "mbedtls/net_sockets.h"\n#include "mbedtls/ripemd160.h"\n#include "mbedtls/x509_crl.h"\n#include "mbedtls/chacha20.h"\n#include "mbedtls/ecjpake.h"\n#include "mbedtls/nist_kw.h"\n#include "mbedtls/rsa.h"\n#include "mbedtls/x509_crt.h"\n#include "mbedtls/chachapoly.h"\n#include "mbedtls/ecp.h"\n#include "mbedtls/oid.h"\n#include "mbedtls/sha1.h"\n#include "mbedtls/x509_csr.h"\n#include "mbedtls/check_config.h"\n#include "mbedtls/entropy.h"\n#include "mbedtls/pem.h"\n#include "mbedtls/sha256.h"\n#include "mbedtls/cipher.h"\n#include "mbedtls/error.h"\n#include "mbedtls/pk.h"\n#include "mbedtls/sha512.h"\n#include "mbedtls/cmac.h"\n#include "mbedtls/gcm.h"\n#include "mbedtls/pkcs12.h"\n#include "mbedtls/ssl.h"\n'
  
  headers: { "/root/workspace/fuzzdrivergpt/install/include" : "**/*" }
  binaries: [ "/src/mbedtls/fuzzdrivergpt-install/lib/libmbedcrypto.a","/src/mbedtls/fuzzdrivergpt-install/lib/libmbedx509.a","/src/mbedtls/fuzzdrivergpt-install/lib/libmbedtls.a" ]
  compile: [ "/usr/local/bin/clang-15", "-isystem", "/usr/local/lib/clang/15.0.0/include", "-isystem", "/usr/local/include", "-isystem", "/usr/include/x86_64-linux-gnu", "-isystem", "/usr/include", "-fsanitize=address", "-fsanitize=fuzzer","-I/root/workspace/fuzzdrivergpt/install/include", "-O1","-fno-omit-frame-pointer","-gline-tables-only","-DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION" ]
  build: "COMPBASE OUTFILE /src/mbedtls/fuzzdrivergpt-install/lib/libmbedtls.a /src/mbedtls/fuzzdrivergpt-install/lib/libmbedx509.a /src/mbedtls/fuzzdrivergpt-install/lib/libmbedcrypto.a    -o OUTEXE"
  run: "OUTEXE -detect_leaks=0 -max_total_time=60 -timeout=30 -artifact_prefix=ARTIFACTDIR/ -close_fd_mask=3 SEEDDIR"
  known_drivers: [ "/src/mbedtls/programs/fuzz/fuzz_client.c","/src/mbedtls/programs/fuzz/fuzz_dtlsclient.c","/src/mbedtls/programs/fuzz/fuzz_dtlsserver.c","/src/mbedtls/programs/fuzz/fuzz_pkcs7.c","/src/mbedtls/programs/fuzz/fuzz_privkey.c","/src/mbedtls/programs/fuzz/fuzz_pubkey.c","/src/mbedtls/programs/fuzz/fuzz_server.c","/src/mbedtls/programs/fuzz/fuzz_x509crl.c","/src/mbedtls/programs/fuzz/fuzz_x509crt.c","/src/mbedtls/programs/fuzz/fuzz_x509csr.c" ]

